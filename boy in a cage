#include <iostream>
#include <conio.h>
#include <cstdio>

FILE* stream;

using namespace std;

int Random(int min, int max) {
	srand(time(NULL));
	int num = min + rand() % (max - min + 1);
	return num;
}

int main() {
	int x, y, x1, y1, x2, y2, toch = 0, score = 0;
	string BLUE = "\x1b[36m";
	string textc = "\x1b[0m";
	char click;

	cout << "enter field lenght: ";
	cin >> x;
	cout << "enter field height: ";
	cin >> y;
	system("cls");


	x = abs(x);
	y = abs(y);

	//двумерный динамический массив
	string** arr = new string * [y + 2];
	for (int i = 0; i < y + 2; i++)
	{
		arr[i] = new string[x + 2];
	}
	//поле
	for (int i = 0; i < y + 2; i++) {
		if (i == 0 or i == y + 1) {
			for (int j = 0; j < x + 2; j++) {
				arr[i][j] = "$ ";
			}
		}
		else {
			for (int j = 0; j < x + 2; j++) {
				if (j == 0 or j == x + 1) {
					arr[i][j] = "$ ";
				}
				else {
					arr[i][j] = "  ";
				}
			}
		}
	}
	//точка в центре
	y1 = (y + 1) / 2;
	x1 = (x + 1) / 2;
	arr[y1][x1] = "+ ";

	do {
		while (toch < 1) {
			y2 = Random(1, y - 1);
			x2 = Random(1, x - 1);
			if (arr[y2][x2] != "+ " and arr[y2][x2] != "# ") {
				arr[y2][x2] = "\x1b[36m x\x1b[0m";
				toch = 1;
			}
		}
		string m = "";
		//массив
		for (int i = 0; i < y + 2; i++) {
			for (int j = 0; j < x + 2; j++) {
				m = m + arr[i][j];
			}
			m = m + "\n";
		}
		cout << m;

		cout << "click 'wasd' to move\npoints [ " << BLUE << score << textc << " ]\n\n\n\n";
		cout << "for exit press esc";

		click = _getch();
		switch (click) {
		//w
		case 'W':
		case 'w':
		{
			if (y1 - 1 == 0) {
				break;
			}
			else {
				arr[y1][x1] = "  ";
				y1 = y1 - 1;
				arr[y1][x1] = "+ ";
				break;
			}
		}
		//s
		case 'S':
		case 's': {
			if (y1 + 1 == y + 1) {
				break;
			}
			else {
				arr[y1][x1] = "  ";
				y1 = y1 + 1;
				arr[y1][x1] = "+ ";
				break;
			}
		}
		//d
		case 'D':
		case 'd': {
			if (x1 + 1 == x + 1) {
				break;
			}
			else {
				arr[y1][x1] = "  ";
				x1 = x1 + 1;
				arr[y1][x1] = "+ ";
				break;
			}
		}
		//a
		case 'A':
		case 'a': {
			if (x1 - 1 == 0) {
				break;
			}
			else {
				arr[y1][x1] = "  ";
				x1 = x1 - 1;
				arr[y1][x1] = "+ ";
				break;
			}
		}
		default:
			break;
		}
		system("cls");

		if (x1 == x2 and y1 == y2) {
			toch = 0;
			score += 1;
		}

	} while (click != '\033');
}
